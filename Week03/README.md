## Go 并发编程

### 1.Goroutine的正确使用姿势

- 一个阻塞函数是否由goroutine承载变为非阻塞状态应该由调用者来决定
- 调用者必须能够感知到goroutine的执行状态(什么时候退出)
- 调用者必须有能力主动让goroutine退出

### 2.机器字

- 计算机分 一，二级缓存，内存，性能依次降低，缓存是与核心绑定的，内存是共享的，所以只有内存中的数据
才是多核可见的。
- 64位操作系统操作8字节一下的数据结构是原子的，由于计算机并行架构的缓存问题，不具备可见性
- 

### 3.同步机制
- 同步锁：如果获取锁失败，程序会进入挂起状态。自旋锁：获取锁失败，程序不会挂起而是不断尝试获取锁直到成功
- 如果多实例同时竞争同步锁，由于同步锁的机制，程序挂起，可能会导致部分实例获取锁的等待时间过长甚至永远获取不到锁
- 自旋锁由于不断的尝试加锁，比较吃CPU
- sync.mutex 与别的语言一样的同步锁，读写锁等等
- atomic 原子操作
- COW(COPY ON WRITE)读时共享，写时复制
- chan 通过通讯来共享数据
- waitGroup 等待goroutine 退出
- errGroup 针对waitGroup进行封装，能够获取协程的执行结果
- context 多协程间传递数据，控制协程退出，超时等等

###  4.chan